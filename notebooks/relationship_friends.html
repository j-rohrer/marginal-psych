<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Julia Rohrer">
<meta name="dcterms.date" content="2025-08-15">

<title>Example 1: Relationship Status and the Importance of Friends</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="relationship_friends_files/libs/clipboard/clipboard.min.js"></script>
<script src="relationship_friends_files/libs/quarto-html/quarto.js"></script>
<script src="relationship_friends_files/libs/quarto-html/popper.min.js"></script>
<script src="relationship_friends_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="relationship_friends_files/libs/quarto-html/anchor.min.js"></script>
<link href="relationship_friends_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="relationship_friends_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="relationship_friends_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="relationship_friends_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="relationship_friends_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#overview" id="toc-overview" class="nav-link active" data-scroll-target="#overview">Overview</a></li>
  <li><a href="#read-and-clean-the-data" id="toc-read-and-clean-the-data" class="nav-link" data-scroll-target="#read-and-clean-the-data">Read and clean the data</a></li>
  <li><a href="#visualize-associations-with-age" id="toc-visualize-associations-with-age" class="nav-link" data-scroll-target="#visualize-associations-with-age">Visualize associations with age</a></li>
  <li><a href="#model-fitting-and-interpretation-with-marginaleffects" id="toc-model-fitting-and-interpretation-with-marginaleffects" class="nav-link" data-scroll-target="#model-fitting-and-interpretation-with-marginaleffects">Model fitting and interpretation with <code>marginaleffects</code></a></li>
  <li><a href="#ordinal-robustness-check" id="toc-ordinal-robustness-check" class="nav-link" data-scroll-target="#ordinal-robustness-check">Ordinal robustness check</a></li>
  <li><a href="#varying-the-complexity-of-the-linear-model-to-see-what-happens" id="toc-varying-the-complexity-of-the-linear-model-to-see-what-happens" class="nav-link" data-scroll-target="#varying-the-complexity-of-the-linear-model-to-see-what-happens">Varying the complexity of the linear model to see what happens</a>
  <ul class="collapse">
  <li><a href="#age-variations" id="toc-age-variations" class="nav-link" data-scroll-target="#age-variations">Age variations</a></li>
  <li><a href="#interaction-variations" id="toc-interaction-variations" class="nav-link" data-scroll-target="#interaction-variations">Interaction variations</a></li>
  </ul></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Example 1: Relationship Status and the Importance of Friends</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Julia Rohrer </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">August 15, 2025</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<p>Before we start, let’s execute a helper script that loads the necessary dependencies.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"scripts/load.R"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: Rcpp</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading 'brms' package (version 2.22.0). Useful instructions
can be found by typing help('brms'). A more detailed introduction
to the package is available through vignette('brms_overview').</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'brms'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:stats':

    ar</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'dplyr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    filter, lag</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    intersect, setdiff, setequal, union</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>here() starts at /Users/juliarohrer/Library/CloudStorage/Dropbox/marginaleffects primer/marginal-psych</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'ordinal'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:dplyr':

    slice</code></pre>
</div>
</div>
<section id="overview" class="level1">
<h1>Overview</h1>
<p>This document contains example 2, in which we analyze the association between relationship status and the importance people assign to friends. Data can be retrieved from the <a href="https://osf.io/gj6x5/files/osfstorage/63b81606c8da86094edf234b" target="_blank">OSF</a> but is also included in the downloadable replication package.</p>
<p>It’s a common complaint that people who enter a relationship start to neglect their friends. Here, we are going to use this to motivate an associational research question: Do people in romantic relationships, on average, assign less importance to their friends? To address this question, we analyze data that were collected in the context of a diary study on satisfaction with various aspects of life <a href="https://online.ucpress.edu/collabra/article/10/1/121238/202884/The-Effects-of-Satisfaction-With-Different-Domains" target="_blank">(Rohrer et al., 2024)</a>. In this study, 482 people reported whether they were in a romantic relationship of any kind (partner) and also the extent to which they considered their friendships important (friendship_importance) on a scale from 1 (not important at all) to 5 (very important).</p>
</section>
<section id="read-and-clean-the-data" class="level1">
<h1>Read and clean the data</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Read the data</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="fu">here</span>(<span class="st">"data/start.csv"</span>))</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Restrict to range that we can model well</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> dat[dat<span class="sc">$</span>sex <span class="sc">!=</span> <span class="dv">3</span>, ] <span class="co"># exclude 5 people who reported a gender distinct from male/female</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> dat[dat<span class="sc">$</span>age <span class="sc">&lt;</span> <span class="dv">60</span>, ] <span class="co"># exclude people over the age of 60</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Limit to complete cases</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> dat[<span class="fu">complete.cases</span>(dat[, <span class="fu">c</span>(<span class="st">"age"</span>, <span class="st">"sex"</span>, <span class="st">"partner_any"</span>, <span class="st">"IMP_friends_Start"</span>)]),]</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>dat<span class="sc">$</span>sex <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(dat<span class="sc">$</span>sex)</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Look at the variables</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(dat<span class="sc">$</span>age)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 
15 28 29 20 15 18 13 16 16 12  4 14  8  3  6  6 13 18 11  9 12 13  6  7 11  6  5  3 11 12 12  7 15 13 14  7  5 11  9 11 10  8 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(dat<span class="sc">$</span>sex)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
  1   2 
347 135 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(dat<span class="sc">$</span>partner_any)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
  0   1 
203 279 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Rename some variables</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> dat <span class="sc">|&gt;</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sex =</span> <span class="fu">factor</span>(sex, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"female"</span>, <span class="st">"male"</span>))) <span class="sc">|&gt;</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">partner =</span> partner_any,</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">gender =</span> sex,</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">friendship_importance =</span> IMP_friends_Start)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="visualize-associations-with-age" class="level1">
<h1>Visualize associations with age</h1>
<p>This code produces Figure 4: Predicted importance of friends by age in three different simple linear models that only include age as a predictor, including (1) age as a linear predictor or (2) age as a categorical predictor, or (3) age splines (B-splines with four degrees of freedom).</p>
<p>Respondents’ age varies from 18 to 59 years. How do we best include this variable in our analysis? If we simply include it as a linear predictor, we assume that friendship_importance changes with age in a linear manner. If, instead, we include it as a categorical predictor (treating each year of age as its own category), we do not impose any assumptions about the functional form—but for some years, we only have few observations, resulting in a trajectory that jumps around a lot, with wide confidence intervals.</p>
<p>So, we may prefer a solution that lies somewhere between these two options. Contenders may be using coarser age categories or using polynomials. A third alternative is splines. These result in flexible, locally smooth trajectories. Unlike polynomials, splines enforce no global functional forms; unlike age categories, splines do not result in abrupt jumps in the trajectory.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Linear association</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>age_lin <span class="ot">&lt;-</span> <span class="fu">lm</span>(friendship_importance <span class="sc">~</span> age, <span class="at">data =</span> dat)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Each year of age as its own category</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>age_cat <span class="ot">&lt;-</span> <span class="fu">lm</span>(friendship_importance <span class="sc">~</span> <span class="fu">as.factor</span>(age), <span class="at">data =</span> dat)</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Smoothed with splines</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>age_smooth <span class="ot">&lt;-</span> <span class="fu">lm</span>(friendship_importance <span class="sc">~</span> <span class="fu">bs</span>(age, <span class="at">df =</span> <span class="dv">4</span>), <span class="at">data =</span> dat)</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract predictions from each of the three models</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>pred_lin <span class="ot">&lt;-</span> <span class="fu">avg_predictions</span>(age_lin, <span class="at">by =</span> <span class="st">"age"</span>)</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>pred_cat <span class="ot">&lt;-</span> <span class="fu">avg_predictions</span>(age_cat, <span class="at">by =</span> <span class="st">"age"</span>)</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>pred_smooth <span class="ot">&lt;-</span> <span class="fu">avg_predictions</span>(age_smooth, <span class="at">by =</span> <span class="st">"age"</span>)</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a><span class="co"># The following code generates a grid that expands the categorical predictions</span></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a><span class="co"># so that we can plot them as a step function including a step ribbon</span></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a><span class="co"># (This is just to get the visuals of Figure 4 right and nothing substantive)</span></span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>pred_cat_expanded <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(<span class="fu">rep</span>(pred_cat<span class="sc">$</span>estimate, <span class="at">each =</span> <span class="dv">100</span>)), <span class="at">ncol =</span> <span class="dv">4</span>))</span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(pred_cat_expanded) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"age"</span>, <span class="st">"estimate"</span>, <span class="st">"conf.low"</span>, <span class="st">"conf.high"</span>)</span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>pred_cat_expanded<span class="sc">$</span>age <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="fu">min</span>(pred_cat<span class="sc">$</span>age), <span class="at">to =</span> (<span class="fu">max</span>(pred_cat<span class="sc">$</span>age) <span class="sc">+</span> <span class="fl">0.999999</span>), <span class="at">length.out =</span> <span class="fu">nrow</span>(pred_cat_expanded))</span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>pred_cat_expanded<span class="sc">$</span>estimate <span class="ot">&lt;-</span> <span class="fu">rep</span>(pred_cat<span class="sc">$</span>estimate, <span class="at">each =</span> <span class="dv">100</span>)</span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>pred_cat_expanded<span class="sc">$</span>conf.low <span class="ot">&lt;-</span> <span class="fu">rep</span>(pred_cat<span class="sc">$</span>conf.low, <span class="at">each =</span> <span class="dv">100</span>)</span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a>pred_cat_expanded<span class="sc">$</span>conf.high <span class="ot">&lt;-</span> <span class="fu">rep</span>(pred_cat<span class="sc">$</span>conf.high, <span class="at">each =</span> <span class="dv">100</span>)</span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Color scheme for Figure 4</span></span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a>col_cat <span class="ot">&lt;-</span> <span class="st">"#E69F00"</span></span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a>col_lin <span class="ot">&lt;-</span> <span class="st">"#D55E00"</span></span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a>col_smooth <span class="ot">&lt;-</span> <span class="st">"#CC79A7"</span></span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-28"><a href="#cb19-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate the plot</span></span>
<span id="cb19-29"><a href="#cb19-29" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb19-30"><a href="#cb19-30" aria-hidden="true" tabindex="-1"></a>  <span class="co"># categorical</span></span>
<span id="cb19-31"><a href="#cb19-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> pred_cat_expanded, <span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> estimate, <span class="at">group =</span> <span class="fu">floor</span>(age)), <span class="at">color =</span> col_cat) <span class="sc">+</span></span>
<span id="cb19-32"><a href="#cb19-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="at">data =</span> pred_cat_expanded, <span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">ymin =</span> conf.low, <span class="at">ymax =</span> conf.high), <span class="at">alpha =</span> .<span class="dv">2</span>, <span class="at">fill =</span> col_cat) <span class="sc">+</span></span>
<span id="cb19-33"><a href="#cb19-33" aria-hidden="true" tabindex="-1"></a>  <span class="co"># linear</span></span>
<span id="cb19-34"><a href="#cb19-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> pred_lin, <span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> estimate), <span class="at">color =</span> col_lin) <span class="sc">+</span></span>
<span id="cb19-35"><a href="#cb19-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="at">data =</span> pred_lin, <span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">ymin =</span> conf.low, <span class="at">ymax =</span> conf.high), <span class="at">alpha =</span> .<span class="dv">2</span>, <span class="at">fill =</span> col_lin) <span class="sc">+</span></span>
<span id="cb19-36"><a href="#cb19-36" aria-hidden="true" tabindex="-1"></a>  <span class="co"># smoothed</span></span>
<span id="cb19-37"><a href="#cb19-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> pred_smooth, <span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> estimate), <span class="at">color =</span> col_smooth) <span class="sc">+</span></span>
<span id="cb19-38"><a href="#cb19-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="at">data =</span> pred_smooth, <span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">ymin =</span> conf.low, <span class="at">ymax =</span> conf.high), <span class="at">alpha =</span> .<span class="dv">2</span>, <span class="at">fill =</span> col_smooth) <span class="sc">+</span></span>
<span id="cb19-39"><a href="#cb19-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="fl">2.5</span>, <span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb19-40"><a href="#cb19-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Age"</span>) <span class="sc">+</span></span>
<span id="cb19-41"><a href="#cb19-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Importance of friends (95% CI)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="relationship_friends_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">here</span>(<span class="st">"plots/age.png"</span>), <span class="at">width =</span> <span class="dv">4</span>, <span class="at">height =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="model-fitting-and-interpretation-with-marginaleffects" class="level1">
<h1>Model fitting and interpretation with <code>marginaleffects</code></h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(friendship_importance <span class="sc">~</span> <span class="fu">bs</span>(age, <span class="at">df =</span> <span class="dv">4</span>) <span class="sc">+</span> gender <span class="sc">+</span> partner <span class="sc">+</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>            <span class="fu">bs</span>(age, <span class="at">df =</span> <span class="dv">4</span>)<span class="sc">:</span>gender <span class="sc">+</span> partner<span class="sc">:</span>gender <span class="sc">+</span> <span class="fu">bs</span>(age, <span class="at">df =</span> <span class="dv">4</span>)<span class="sc">:</span>partner, <span class="at">data =</span> dat)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Predictions for a 20 year old single</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="fu">predictions</span>(mod, <span class="at">newdata =</span> <span class="fu">datagrid</span>(<span class="at">age =</span> <span class="dv">20</span>, <span class="at">gender =</span> <span class="st">"male"</span>, <span class="at">partner =</span> <span class="dv">0</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<!-- preamble start -->

    <script>

      function styleCell_poev5bg8amlpon6cor01(i, j, css_id) {
          var table = document.getElementById("tinytable_poev5bg8amlpon6cor01");
          var cell = table.querySelector(`[data-row="${i}"][data-col="${j}"]`);
          if (cell) {
              console.log(`Styling cell at (${i}, ${j}) with class ${css_id}`);
              cell.classList.add(css_id);
          } else {
              console.warn(`Cell at (${i}, ${j}) not found.`);
          }
      }
      function insertSpanRow(i, colspan, content) {
        var table = document.getElementById('tinytable_poev5bg8amlpon6cor01');
        // Find the row with data-row attribute matching i
        var targetRow = table.querySelector(`tr [data-row="${i}"]`).closest('tr');
        var newRow = table.insertRow(targetRow.rowIndex);
        var newCell = newRow.insertCell(0);
        newCell.setAttribute("colspan", colspan);
        newCell.setAttribute("data-col", "0");
        newCell.setAttribute("data-row", i - 1);
        // newCell.innerText = content;
        // this may be unsafe, but innerText does not interpret <br>
        newCell.innerHTML = content;
      }
      function spanCell_poev5bg8amlpon6cor01(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_poev5bg8amlpon6cor01");
        const targetCell = table.querySelector(`[data-row="${i}"][data-col="${j}"]`);
        if (!targetCell) {
          console.warn(`Cell at (${i}, ${j}) not found.`);
        }

        // Get all cells that need to be removed
        const cellsToRemove = [];
        for (let r = 0; r < rowspan; r++) {
          for (let c = 0; c < colspan; c++) {
            if (r === 0 && c === 0) continue; // Skip the target cell
            const cell = table.querySelector(`[data-row="${i + r}"][data-col="${j + c}"]`);
            if (cell) {
              cellsToRemove.push(cell);
            }
          }
        }

        // Remove all cells
        cellsToRemove.forEach(cell => cell.remove());

        // Set rowspan and colspan of the target cell if it exists
        if (targetCell) {
          targetCell.rowSpan = rowspan;
          targetCell.colSpan = colspan;
        }
      }
      // tinytable span after
      window.addEventListener('load', function () {
          var cellsToStyle = [
            // tinytable style arrays after
          { positions: [ { i: '1', j: 0 }, { i: '1', j: 1 }, { i: '1', j: 2 }, { i: '1', j: 3 }, { i: '1', j: 4 }, { i: '1', j: 5 }, { i: '1', j: 6 }, { i: '1', j: 7 }, { i: '1', j: 8 }, { i: '1', j: 9 },  ], css_id: 'tinytable_css_b9jnv4vo03sp8d5izw6w',}, 
          { positions: [ { i: '0', j: 0 }, { i: '0', j: 1 }, { i: '0', j: 2 }, { i: '0', j: 3 }, { i: '0', j: 4 }, { i: '0', j: 5 }, { i: '0', j: 6 }, { i: '0', j: 7 }, { i: '0', j: 8 }, { i: '0', j: 9 },  ], css_id: 'tinytable_css_38vg4bzzm28y6t8hcvfc',}, 
          ];

          // Loop over the arrays to style the cells
          cellsToStyle.forEach(function (group) {
              group.positions.forEach(function (cell) {
                  styleCell_poev5bg8amlpon6cor01(cell.i, cell.j, group.css_id);
              });
          });
      });
    </script>

    <style>
      /* tinytable css entries after */
      .table td.tinytable_css_b9jnv4vo03sp8d5izw6w, .table th.tinytable_css_b9jnv4vo03sp8d5izw6w { border-bottom: solid #d3d8dc 0.1em; }
      .table td.tinytable_css_38vg4bzzm28y6t8hcvfc, .table th.tinytable_css_38vg4bzzm28y6t8hcvfc { border-top: solid #d3d8dc 0.1em; border-bottom: solid #d3d8dc 0.05em; }
    </style>
    <div class="container">
      <table class="table table-borderless" id="tinytable_poev5bg8amlpon6cor01" style="width: auto; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
        <thead>
        
              <tr>
                <th scope="col" data-row="0" data-col="0">age</th>
                <th scope="col" data-row="0" data-col="1">gender</th>
                <th scope="col" data-row="0" data-col="2">partner</th>
                <th scope="col" data-row="0" data-col="3">Estimate</th>
                <th scope="col" data-row="0" data-col="4">Std. Error</th>
                <th scope="col" data-row="0" data-col="5">z</th>
                <th scope="col" data-row="0" data-col="6">Pr(&gt;|z|)</th>
                <th scope="col" data-row="0" data-col="7">S</th>
                <th scope="col" data-row="0" data-col="8">2.5 %</th>
                <th scope="col" data-row="0" data-col="9">97.5 %</th>
              </tr>
        </thead>
        
        <tbody>
                <tr>
                  <td data-row="1" data-col="0">20</td>
                  <td data-row="1" data-col="1">male</td>
                  <td data-row="1" data-col="2">0</td>
                  <td data-row="1" data-col="3">4.66</td>
                  <td data-row="1" data-col="4">0.243</td>
                  <td data-row="1" data-col="5">19.2</td>
                  <td data-row="1" data-col="6">&lt;0.001</td>
                  <td data-row="1" data-col="7">269.4</td>
                  <td data-row="1" data-col="8">4.18</td>
                  <td data-row="1" data-col="9">5.13</td>
                </tr>
        </tbody>
      </table>
    </div>
<!-- hack to avoid NA insertion in last line -->
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Slope of age for a 20 year old single</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">slopes</span>(mod, <span class="at">variables =</span> <span class="st">"age"</span>, <span class="at">newdata =</span> <span class="fu">datagrid</span>(<span class="at">age =</span> <span class="dv">20</span>, <span class="at">gender =</span> <span class="st">"male"</span>, <span class="at">partner =</span> <span class="dv">0</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<!-- preamble start -->

    <script>

      function styleCell_7zbwwao6w414r7ziypkx(i, j, css_id) {
          var table = document.getElementById("tinytable_7zbwwao6w414r7ziypkx");
          var cell = table.querySelector(`[data-row="${i}"][data-col="${j}"]`);
          if (cell) {
              console.log(`Styling cell at (${i}, ${j}) with class ${css_id}`);
              cell.classList.add(css_id);
          } else {
              console.warn(`Cell at (${i}, ${j}) not found.`);
          }
      }
      function insertSpanRow(i, colspan, content) {
        var table = document.getElementById('tinytable_7zbwwao6w414r7ziypkx');
        // Find the row with data-row attribute matching i
        var targetRow = table.querySelector(`tr [data-row="${i}"]`).closest('tr');
        var newRow = table.insertRow(targetRow.rowIndex);
        var newCell = newRow.insertCell(0);
        newCell.setAttribute("colspan", colspan);
        newCell.setAttribute("data-col", "0");
        newCell.setAttribute("data-row", i - 1);
        // newCell.innerText = content;
        // this may be unsafe, but innerText does not interpret <br>
        newCell.innerHTML = content;
      }
      function spanCell_7zbwwao6w414r7ziypkx(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_7zbwwao6w414r7ziypkx");
        const targetCell = table.querySelector(`[data-row="${i}"][data-col="${j}"]`);
        if (!targetCell) {
          console.warn(`Cell at (${i}, ${j}) not found.`);
        }

        // Get all cells that need to be removed
        const cellsToRemove = [];
        for (let r = 0; r < rowspan; r++) {
          for (let c = 0; c < colspan; c++) {
            if (r === 0 && c === 0) continue; // Skip the target cell
            const cell = table.querySelector(`[data-row="${i + r}"][data-col="${j + c}"]`);
            if (cell) {
              cellsToRemove.push(cell);
            }
          }
        }

        // Remove all cells
        cellsToRemove.forEach(cell => cell.remove());

        // Set rowspan and colspan of the target cell if it exists
        if (targetCell) {
          targetCell.rowSpan = rowspan;
          targetCell.colSpan = colspan;
        }
      }
      // tinytable span after
      window.addEventListener('load', function () {
          var cellsToStyle = [
            // tinytable style arrays after
          { positions: [ { i: '1', j: 0 }, { i: '1', j: 1 }, { i: '1', j: 2 }, { i: '1', j: 3 }, { i: '1', j: 4 }, { i: '1', j: 5 }, { i: '1', j: 6 }, { i: '1', j: 7 }, { i: '1', j: 8 }, { i: '1', j: 9 },  ], css_id: 'tinytable_css_o7u9idue0imt3lud355w',}, 
          { positions: [ { i: '0', j: 0 }, { i: '0', j: 1 }, { i: '0', j: 2 }, { i: '0', j: 3 }, { i: '0', j: 4 }, { i: '0', j: 5 }, { i: '0', j: 6 }, { i: '0', j: 7 }, { i: '0', j: 8 }, { i: '0', j: 9 },  ], css_id: 'tinytable_css_kmkv5ehw2dz8riixqrmj',}, 
          ];

          // Loop over the arrays to style the cells
          cellsToStyle.forEach(function (group) {
              group.positions.forEach(function (cell) {
                  styleCell_7zbwwao6w414r7ziypkx(cell.i, cell.j, group.css_id);
              });
          });
      });
    </script>

    <style>
      /* tinytable css entries after */
      .table td.tinytable_css_o7u9idue0imt3lud355w, .table th.tinytable_css_o7u9idue0imt3lud355w { border-bottom: solid #d3d8dc 0.1em; }
      .table td.tinytable_css_kmkv5ehw2dz8riixqrmj, .table th.tinytable_css_kmkv5ehw2dz8riixqrmj { border-top: solid #d3d8dc 0.1em; border-bottom: solid #d3d8dc 0.05em; }
    </style>
    <div class="container">
      <table class="table table-borderless" id="tinytable_7zbwwao6w414r7ziypkx" style="width: auto; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
        <thead>
        
              <tr>
                <th scope="col" data-row="0" data-col="0">age</th>
                <th scope="col" data-row="0" data-col="1">gender</th>
                <th scope="col" data-row="0" data-col="2">partner</th>
                <th scope="col" data-row="0" data-col="3">Estimate</th>
                <th scope="col" data-row="0" data-col="4">Std. Error</th>
                <th scope="col" data-row="0" data-col="5">z</th>
                <th scope="col" data-row="0" data-col="6">Pr(&gt;|z|)</th>
                <th scope="col" data-row="0" data-col="7">S</th>
                <th scope="col" data-row="0" data-col="8">2.5 %</th>
                <th scope="col" data-row="0" data-col="9">97.5 %</th>
              </tr>
        </thead>
        
        <tbody>
                <tr>
                  <td data-row="1" data-col="0">20</td>
                  <td data-row="1" data-col="1">male</td>
                  <td data-row="1" data-col="2">0</td>
                  <td data-row="1" data-col="3">0.00329</td>
                  <td data-row="1" data-col="4">0.104</td>
                  <td data-row="1" data-col="5">0.0318</td>
                  <td data-row="1" data-col="6">0.975</td>
                  <td data-row="1" data-col="7">0.0</td>
                  <td data-row="1" data-col="8">-0.2</td>
                  <td data-row="1" data-col="9">0.207</td>
                </tr>
        </tbody>
      </table>
    </div>
<!-- hack to avoid NA insertion in last line -->
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Predictions for everybody in the data</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">predictions</span>(mod)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<!-- preamble start -->

    <script>

      function styleCell_dj93josvdfo5rtnwybq4(i, j, css_id) {
          var table = document.getElementById("tinytable_dj93josvdfo5rtnwybq4");
          var cell = table.querySelector(`[data-row="${i}"][data-col="${j}"]`);
          if (cell) {
              console.log(`Styling cell at (${i}, ${j}) with class ${css_id}`);
              cell.classList.add(css_id);
          } else {
              console.warn(`Cell at (${i}, ${j}) not found.`);
          }
      }
      function insertSpanRow_w738enkgg7mbbrjrmukh(i, colspan, content) {
        var table = document.getElementById('tinytable_dj93josvdfo5rtnwybq4');
        // Find the row with data-row attribute matching i
        var targetRow = table.querySelector(`tr [data-row="${i}"]`).closest('tr');
        var newRow = table.insertRow(targetRow.rowIndex);
        var newCell = newRow.insertCell(0);
        newCell.setAttribute("colspan", colspan);
        newCell.setAttribute("data-col", "0");
        newCell.setAttribute("data-row", i - 1);
        // newCell.innerText = content;
        // this may be unsafe, but innerText does not interpret <br>
        newCell.innerHTML = content;
      }
      function spanCell_dj93josvdfo5rtnwybq4(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_dj93josvdfo5rtnwybq4");
        const targetCell = table.querySelector(`[data-row="${i}"][data-col="${j}"]`);
        if (!targetCell) {
          console.warn(`Cell at (${i}, ${j}) not found.`);
        }

        // Get all cells that need to be removed
        const cellsToRemove = [];
        for (let r = 0; r < rowspan; r++) {
          for (let c = 0; c < colspan; c++) {
            if (r === 0 && c === 0) continue; // Skip the target cell
            const cell = table.querySelector(`[data-row="${i + r}"][data-col="${j + c}"]`);
            if (cell) {
              cellsToRemove.push(cell);
            }
          }
        }

        // Remove all cells
        cellsToRemove.forEach(cell => cell.remove());

        // Set rowspan and colspan of the target cell if it exists
        if (targetCell) {
          targetCell.rowSpan = rowspan;
          targetCell.colSpan = colspan;
        }
      }
      // tinytable span after
      window.addEventListener('load', function () { insertSpanRow_w738enkgg7mbbrjrmukh(7, 7, '472 rows omitted') });
      window.addEventListener('load', function () {
          var cellsToStyle = [
            // tinytable style arrays after
          { positions: [ { i: '11', j: 1 }, { i: '11', j: 2 }, { i: '11', j: 5 }, { i: '11', j: 4 }, { i: '11', j: 3 }, { i: '11', j: 6 },  ], css_id: 'tinytable_css_jt4k8h4z0tvjbhoh6imt',}, 
          { positions: [ { i: '11', j: 0 },  ], css_id: 'tinytable_css_49v07cdqzlgs54w7sb7h',}, 
          { positions: [ { i: '6', j: 0 }, { i: '6', j: 1 }, { i: '6', j: 4 }, { i: '6', j: 3 }, { i: '6', j: 2 }, { i: '6', j: 5 }, { i: '6', j: 6 },  ], css_id: 'tinytable_css_n5dotx52m65e3nju4eop',}, 
          { positions: [ { i: '1', j: 0 }, { i: '2', j: 0 }, { i: '5', j: 0 }, { i: '10', j: 0 }, { i: '3', j: 0 }, { i: '4', j: 0 }, { i: '9', j: 0 }, { i: '7', j: 0 }, { i: '8', j: 0 },  ], css_id: 'tinytable_css_0q4nw1047ju6zn5cydz4',}, 
          { positions: [ { i: '0', j: 0 }, { i: '0', j: 4 }, { i: '0', j: 3 }, { i: '0', j: 2 }, { i: '0', j: 1 }, { i: '0', j: 6 }, { i: '0', j: 5 },  ], css_id: 'tinytable_css_zoosbdix2o0lmpei7ldi',}, 
          ];

          // Loop over the arrays to style the cells
          cellsToStyle.forEach(function (group) {
              group.positions.forEach(function (cell) {
                  styleCell_dj93josvdfo5rtnwybq4(cell.i, cell.j, group.css_id);
              });
          });
      });
    </script>

    <style>
      /* tinytable css entries after */
      .table td.tinytable_css_jt4k8h4z0tvjbhoh6imt, .table th.tinytable_css_jt4k8h4z0tvjbhoh6imt { border-bottom: solid #d3d8dc 0.1em; }
      .table td.tinytable_css_49v07cdqzlgs54w7sb7h, .table th.tinytable_css_49v07cdqzlgs54w7sb7h { padding-left: 1em; border-bottom: solid #d3d8dc 0.1em; }
      .table td.tinytable_css_n5dotx52m65e3nju4eop, .table th.tinytable_css_n5dotx52m65e3nju4eop { text-align: center; }
      .table td.tinytable_css_0q4nw1047ju6zn5cydz4, .table th.tinytable_css_0q4nw1047ju6zn5cydz4 { padding-left: 1em; }
      .table td.tinytable_css_zoosbdix2o0lmpei7ldi, .table th.tinytable_css_zoosbdix2o0lmpei7ldi { border-top: solid #d3d8dc 0.1em; border-bottom: solid #d3d8dc 0.05em; }
    </style>
    <div class="container">
      <table class="table table-borderless" id="tinytable_dj93josvdfo5rtnwybq4" style="width: auto; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
        <thead>
        
              <tr>
                <th scope="col" data-row="0" data-col="0">Estimate</th>
                <th scope="col" data-row="0" data-col="1">Std. Error</th>
                <th scope="col" data-row="0" data-col="2">z</th>
                <th scope="col" data-row="0" data-col="3">Pr(&gt;|z|)</th>
                <th scope="col" data-row="0" data-col="4">S</th>
                <th scope="col" data-row="0" data-col="5">2.5 %</th>
                <th scope="col" data-row="0" data-col="6">97.5 %</th>
              </tr>
        </thead>
        
        <tbody>
                <tr>
                  <td data-row="1" data-col="0">4.46</td>
                  <td data-row="1" data-col="1">0.1485</td>
                  <td data-row="1" data-col="2">30.0</td>
                  <td data-row="1" data-col="3">&lt;0.001</td>
                  <td data-row="1" data-col="4">654.5</td>
                  <td data-row="1" data-col="5">4.17</td>
                  <td data-row="1" data-col="6">4.75</td>
                </tr>
                <tr>
                  <td data-row="2" data-col="0">4.58</td>
                  <td data-row="2" data-col="1">0.1362</td>
                  <td data-row="2" data-col="2">33.6</td>
                  <td data-row="2" data-col="3">&lt;0.001</td>
                  <td data-row="2" data-col="4">819.9</td>
                  <td data-row="2" data-col="5">4.31</td>
                  <td data-row="2" data-col="6">4.85</td>
                </tr>
                <tr>
                  <td data-row="3" data-col="0">4.45</td>
                  <td data-row="3" data-col="1">0.1131</td>
                  <td data-row="3" data-col="2">39.3</td>
                  <td data-row="3" data-col="3">&lt;0.001</td>
                  <td data-row="3" data-col="4">Inf</td>
                  <td data-row="3" data-col="5">4.23</td>
                  <td data-row="3" data-col="6">4.67</td>
                </tr>
                <tr>
                  <td data-row="4" data-col="0">4.41</td>
                  <td data-row="4" data-col="1">0.0994</td>
                  <td data-row="4" data-col="2">44.4</td>
                  <td data-row="4" data-col="3">&lt;0.001</td>
                  <td data-row="4" data-col="4">Inf</td>
                  <td data-row="4" data-col="5">4.22</td>
                  <td data-row="4" data-col="6">4.61</td>
                </tr>
                <tr>
                  <td data-row="5" data-col="0">4.52</td>
                  <td data-row="5" data-col="1">0.1447</td>
                  <td data-row="5" data-col="2">31.2</td>
                  <td data-row="5" data-col="3">&lt;0.001</td>
                  <td data-row="5" data-col="4">709.7</td>
                  <td data-row="5" data-col="5">4.24</td>
                  <td data-row="5" data-col="6">4.81</td>
                </tr>
                <tr>
                  <td data-row="7" data-col="0">4.66</td>
                  <td data-row="7" data-col="1">0.1341</td>
                  <td data-row="7" data-col="2">34.8</td>
                  <td data-row="7" data-col="3">&lt;0.001</td>
                  <td data-row="7" data-col="4">876.7</td>
                  <td data-row="7" data-col="5">4.40</td>
                  <td data-row="7" data-col="6">4.92</td>
                </tr>
                <tr>
                  <td data-row="8" data-col="0">4.63</td>
                  <td data-row="8" data-col="1">0.1872</td>
                  <td data-row="8" data-col="2">24.7</td>
                  <td data-row="8" data-col="3">&lt;0.001</td>
                  <td data-row="8" data-col="4">446.4</td>
                  <td data-row="8" data-col="5">4.26</td>
                  <td data-row="8" data-col="6">5.00</td>
                </tr>
                <tr>
                  <td data-row="9" data-col="0">4.46</td>
                  <td data-row="9" data-col="1">0.1480</td>
                  <td data-row="9" data-col="2">30.1</td>
                  <td data-row="9" data-col="3">&lt;0.001</td>
                  <td data-row="9" data-col="4">659.1</td>
                  <td data-row="9" data-col="5">4.17</td>
                  <td data-row="9" data-col="6">4.75</td>
                </tr>
                <tr>
                  <td data-row="10" data-col="0">4.46</td>
                  <td data-row="10" data-col="1">0.1480</td>
                  <td data-row="10" data-col="2">30.1</td>
                  <td data-row="10" data-col="3">&lt;0.001</td>
                  <td data-row="10" data-col="4">659.1</td>
                  <td data-row="10" data-col="5">4.17</td>
                  <td data-row="10" data-col="6">4.75</td>
                </tr>
                <tr>
                  <td data-row="11" data-col="0">4.67</td>
                  <td data-row="11" data-col="1">0.1104</td>
                  <td data-row="11" data-col="2">42.2</td>
                  <td data-row="11" data-col="3">&lt;0.001</td>
                  <td data-row="11" data-col="4">Inf</td>
                  <td data-row="11" data-col="5">4.45</td>
                  <td data-row="11" data-col="6">4.88</td>
                </tr>
        </tbody>
      </table>
    </div>
<!-- hack to avoid NA insertion in last line -->
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Main result: Difference in friendship importance with and without partner, holding constant age and gender</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">avg_comparisons</span>(mod, <span class="at">variables =</span> <span class="st">"partner"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<!-- preamble start -->

    <script>

      function styleCell_yolwbaooqhgteuezz188(i, j, css_id) {
          var table = document.getElementById("tinytable_yolwbaooqhgteuezz188");
          var cell = table.querySelector(`[data-row="${i}"][data-col="${j}"]`);
          if (cell) {
              console.log(`Styling cell at (${i}, ${j}) with class ${css_id}`);
              cell.classList.add(css_id);
          } else {
              console.warn(`Cell at (${i}, ${j}) not found.`);
          }
      }
      function insertSpanRow(i, colspan, content) {
        var table = document.getElementById('tinytable_yolwbaooqhgteuezz188');
        // Find the row with data-row attribute matching i
        var targetRow = table.querySelector(`tr [data-row="${i}"]`).closest('tr');
        var newRow = table.insertRow(targetRow.rowIndex);
        var newCell = newRow.insertCell(0);
        newCell.setAttribute("colspan", colspan);
        newCell.setAttribute("data-col", "0");
        newCell.setAttribute("data-row", i - 1);
        // newCell.innerText = content;
        // this may be unsafe, but innerText does not interpret <br>
        newCell.innerHTML = content;
      }
      function spanCell_yolwbaooqhgteuezz188(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_yolwbaooqhgteuezz188");
        const targetCell = table.querySelector(`[data-row="${i}"][data-col="${j}"]`);
        if (!targetCell) {
          console.warn(`Cell at (${i}, ${j}) not found.`);
        }

        // Get all cells that need to be removed
        const cellsToRemove = [];
        for (let r = 0; r < rowspan; r++) {
          for (let c = 0; c < colspan; c++) {
            if (r === 0 && c === 0) continue; // Skip the target cell
            const cell = table.querySelector(`[data-row="${i + r}"][data-col="${j + c}"]`);
            if (cell) {
              cellsToRemove.push(cell);
            }
          }
        }

        // Remove all cells
        cellsToRemove.forEach(cell => cell.remove());

        // Set rowspan and colspan of the target cell if it exists
        if (targetCell) {
          targetCell.rowSpan = rowspan;
          targetCell.colSpan = colspan;
        }
      }
      // tinytable span after
      window.addEventListener('load', function () {
          var cellsToStyle = [
            // tinytable style arrays after
          { positions: [ { i: '1', j: 0 }, { i: '1', j: 1 }, { i: '1', j: 2 }, { i: '1', j: 3 }, { i: '1', j: 4 }, { i: '1', j: 5 }, { i: '1', j: 6 },  ], css_id: 'tinytable_css_x9806csc45mewd9ywnf5',}, 
          { positions: [ { i: '0', j: 0 }, { i: '0', j: 1 }, { i: '0', j: 2 }, { i: '0', j: 3 }, { i: '0', j: 4 }, { i: '0', j: 5 }, { i: '0', j: 6 },  ], css_id: 'tinytable_css_h9ri83d4hzs2t09jxm2t',}, 
          ];

          // Loop over the arrays to style the cells
          cellsToStyle.forEach(function (group) {
              group.positions.forEach(function (cell) {
                  styleCell_yolwbaooqhgteuezz188(cell.i, cell.j, group.css_id);
              });
          });
      });
    </script>

    <style>
      /* tinytable css entries after */
      .table td.tinytable_css_x9806csc45mewd9ywnf5, .table th.tinytable_css_x9806csc45mewd9ywnf5 { border-bottom: solid #d3d8dc 0.1em; }
      .table td.tinytable_css_h9ri83d4hzs2t09jxm2t, .table th.tinytable_css_h9ri83d4hzs2t09jxm2t { border-top: solid #d3d8dc 0.1em; border-bottom: solid #d3d8dc 0.05em; }
    </style>
    <div class="container">
      <table class="table table-borderless" id="tinytable_yolwbaooqhgteuezz188" style="width: auto; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
        <thead>
        
              <tr>
                <th scope="col" data-row="0" data-col="0">Estimate</th>
                <th scope="col" data-row="0" data-col="1">Std. Error</th>
                <th scope="col" data-row="0" data-col="2">z</th>
                <th scope="col" data-row="0" data-col="3">Pr(&gt;|z|)</th>
                <th scope="col" data-row="0" data-col="4">S</th>
                <th scope="col" data-row="0" data-col="5">2.5 %</th>
                <th scope="col" data-row="0" data-col="6">97.5 %</th>
              </tr>
        </thead>
        
        <tbody>
                <tr>
                  <td data-row="1" data-col="0">-0.072</td>
                  <td data-row="1" data-col="1">0.0804</td>
                  <td data-row="1" data-col="2">-0.896</td>
                  <td data-row="1" data-col="3">0.37</td>
                  <td data-row="1" data-col="4">1.4</td>
                  <td data-row="1" data-col="5">-0.23</td>
                  <td data-row="1" data-col="6">0.0856</td>
                </tr>
        </tbody>
      </table>
    </div>
<!-- hack to avoid NA insertion in last line -->
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate separate estimates of the difference, by gender</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">avg_comparisons</span>(mod, <span class="at">variables =</span> <span class="st">"partner"</span>, <span class="at">by =</span> <span class="st">"gender"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<!-- preamble start -->

    <script>

      function styleCell_bxzq1yzrkhyfepz9y9z1(i, j, css_id) {
          var table = document.getElementById("tinytable_bxzq1yzrkhyfepz9y9z1");
          var cell = table.querySelector(`[data-row="${i}"][data-col="${j}"]`);
          if (cell) {
              console.log(`Styling cell at (${i}, ${j}) with class ${css_id}`);
              cell.classList.add(css_id);
          } else {
              console.warn(`Cell at (${i}, ${j}) not found.`);
          }
      }
      function insertSpanRow(i, colspan, content) {
        var table = document.getElementById('tinytable_bxzq1yzrkhyfepz9y9z1');
        // Find the row with data-row attribute matching i
        var targetRow = table.querySelector(`tr [data-row="${i}"]`).closest('tr');
        var newRow = table.insertRow(targetRow.rowIndex);
        var newCell = newRow.insertCell(0);
        newCell.setAttribute("colspan", colspan);
        newCell.setAttribute("data-col", "0");
        newCell.setAttribute("data-row", i - 1);
        // newCell.innerText = content;
        // this may be unsafe, but innerText does not interpret <br>
        newCell.innerHTML = content;
      }
      function spanCell_bxzq1yzrkhyfepz9y9z1(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_bxzq1yzrkhyfepz9y9z1");
        const targetCell = table.querySelector(`[data-row="${i}"][data-col="${j}"]`);
        if (!targetCell) {
          console.warn(`Cell at (${i}, ${j}) not found.`);
        }

        // Get all cells that need to be removed
        const cellsToRemove = [];
        for (let r = 0; r < rowspan; r++) {
          for (let c = 0; c < colspan; c++) {
            if (r === 0 && c === 0) continue; // Skip the target cell
            const cell = table.querySelector(`[data-row="${i + r}"][data-col="${j + c}"]`);
            if (cell) {
              cellsToRemove.push(cell);
            }
          }
        }

        // Remove all cells
        cellsToRemove.forEach(cell => cell.remove());

        // Set rowspan and colspan of the target cell if it exists
        if (targetCell) {
          targetCell.rowSpan = rowspan;
          targetCell.colSpan = colspan;
        }
      }
      // tinytable span after
      window.addEventListener('load', function () {
          var cellsToStyle = [
            // tinytable style arrays after
          { positions: [ { i: '2', j: 0 }, { i: '2', j: 1 }, { i: '2', j: 2 }, { i: '2', j: 3 }, { i: '2', j: 4 }, { i: '2', j: 5 }, { i: '2', j: 6 }, { i: '2', j: 7 },  ], css_id: 'tinytable_css_61ku5vbnbely1q2vau2k',}, 
          { positions: [ { i: '0', j: 0 }, { i: '0', j: 1 }, { i: '0', j: 2 }, { i: '0', j: 3 }, { i: '0', j: 4 }, { i: '0', j: 5 }, { i: '0', j: 6 }, { i: '0', j: 7 },  ], css_id: 'tinytable_css_010czjdlcrx4gim7s1h9',}, 
          ];

          // Loop over the arrays to style the cells
          cellsToStyle.forEach(function (group) {
              group.positions.forEach(function (cell) {
                  styleCell_bxzq1yzrkhyfepz9y9z1(cell.i, cell.j, group.css_id);
              });
          });
      });
    </script>

    <style>
      /* tinytable css entries after */
      .table td.tinytable_css_61ku5vbnbely1q2vau2k, .table th.tinytable_css_61ku5vbnbely1q2vau2k { border-bottom: solid #d3d8dc 0.1em; }
      .table td.tinytable_css_010czjdlcrx4gim7s1h9, .table th.tinytable_css_010czjdlcrx4gim7s1h9 { border-top: solid #d3d8dc 0.1em; border-bottom: solid #d3d8dc 0.05em; }
    </style>
    <div class="container">
      <table class="table table-borderless" id="tinytable_bxzq1yzrkhyfepz9y9z1" style="width: auto; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
        <thead>
        
              <tr>
                <th scope="col" data-row="0" data-col="0">gender</th>
                <th scope="col" data-row="0" data-col="1">Estimate</th>
                <th scope="col" data-row="0" data-col="2">Std. Error</th>
                <th scope="col" data-row="0" data-col="3">z</th>
                <th scope="col" data-row="0" data-col="4">Pr(&gt;|z|)</th>
                <th scope="col" data-row="0" data-col="5">S</th>
                <th scope="col" data-row="0" data-col="6">2.5 %</th>
                <th scope="col" data-row="0" data-col="7">97.5 %</th>
              </tr>
        </thead>
        
        <tbody>
                <tr>
                  <td data-row="1" data-col="0">female</td>
                  <td data-row="1" data-col="1">-0.0738</td>
                  <td data-row="1" data-col="2">0.0946</td>
                  <td data-row="1" data-col="3">-0.780</td>
                  <td data-row="1" data-col="4">0.436</td>
                  <td data-row="1" data-col="5">1.2</td>
                  <td data-row="1" data-col="6">-0.259</td>
                  <td data-row="1" data-col="7">0.112</td>
                </tr>
                <tr>
                  <td data-row="2" data-col="0">male</td>
                  <td data-row="2" data-col="1">-0.0675</td>
                  <td data-row="2" data-col="2">0.1529</td>
                  <td data-row="2" data-col="3">-0.442</td>
                  <td data-row="2" data-col="4">0.659</td>
                  <td data-row="2" data-col="5">0.6</td>
                  <td data-row="2" data-col="6">-0.367</td>
                  <td data-row="2" data-col="7">0.232</td>
                </tr>
        </tbody>
      </table>
    </div>
<!-- hack to avoid NA insertion in last line -->
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare these gender-specific estimates</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="fu">avg_comparisons</span>(mod, <span class="at">variables =</span> <span class="st">"partner"</span>, <span class="at">by =</span> <span class="st">"gender"</span>, <span class="at">hypothesis =</span> <span class="st">"b2 - b1 = 0"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<!-- preamble start -->

    <script>

      function styleCell_fku0bo1yl1x02zynd5zy(i, j, css_id) {
          var table = document.getElementById("tinytable_fku0bo1yl1x02zynd5zy");
          var cell = table.querySelector(`[data-row="${i}"][data-col="${j}"]`);
          if (cell) {
              console.log(`Styling cell at (${i}, ${j}) with class ${css_id}`);
              cell.classList.add(css_id);
          } else {
              console.warn(`Cell at (${i}, ${j}) not found.`);
          }
      }
      function insertSpanRow(i, colspan, content) {
        var table = document.getElementById('tinytable_fku0bo1yl1x02zynd5zy');
        // Find the row with data-row attribute matching i
        var targetRow = table.querySelector(`tr [data-row="${i}"]`).closest('tr');
        var newRow = table.insertRow(targetRow.rowIndex);
        var newCell = newRow.insertCell(0);
        newCell.setAttribute("colspan", colspan);
        newCell.setAttribute("data-col", "0");
        newCell.setAttribute("data-row", i - 1);
        // newCell.innerText = content;
        // this may be unsafe, but innerText does not interpret <br>
        newCell.innerHTML = content;
      }
      function spanCell_fku0bo1yl1x02zynd5zy(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_fku0bo1yl1x02zynd5zy");
        const targetCell = table.querySelector(`[data-row="${i}"][data-col="${j}"]`);
        if (!targetCell) {
          console.warn(`Cell at (${i}, ${j}) not found.`);
        }

        // Get all cells that need to be removed
        const cellsToRemove = [];
        for (let r = 0; r < rowspan; r++) {
          for (let c = 0; c < colspan; c++) {
            if (r === 0 && c === 0) continue; // Skip the target cell
            const cell = table.querySelector(`[data-row="${i + r}"][data-col="${j + c}"]`);
            if (cell) {
              cellsToRemove.push(cell);
            }
          }
        }

        // Remove all cells
        cellsToRemove.forEach(cell => cell.remove());

        // Set rowspan and colspan of the target cell if it exists
        if (targetCell) {
          targetCell.rowSpan = rowspan;
          targetCell.colSpan = colspan;
        }
      }
      // tinytable span after
      window.addEventListener('load', function () {
          var cellsToStyle = [
            // tinytable style arrays after
          { positions: [ { i: '1', j: 0 }, { i: '1', j: 1 }, { i: '1', j: 2 }, { i: '1', j: 3 }, { i: '1', j: 4 }, { i: '1', j: 5 }, { i: '1', j: 6 }, { i: '1', j: 7 },  ], css_id: 'tinytable_css_itrvvd8tczrc09npwokp',}, 
          { positions: [ { i: '0', j: 0 }, { i: '0', j: 1 }, { i: '0', j: 2 }, { i: '0', j: 3 }, { i: '0', j: 4 }, { i: '0', j: 5 }, { i: '0', j: 6 }, { i: '0', j: 7 },  ], css_id: 'tinytable_css_e8rtdy7varwkbzcm099m',}, 
          ];

          // Loop over the arrays to style the cells
          cellsToStyle.forEach(function (group) {
              group.positions.forEach(function (cell) {
                  styleCell_fku0bo1yl1x02zynd5zy(cell.i, cell.j, group.css_id);
              });
          });
      });
    </script>

    <style>
      /* tinytable css entries after */
      .table td.tinytable_css_itrvvd8tczrc09npwokp, .table th.tinytable_css_itrvvd8tczrc09npwokp { border-bottom: solid #d3d8dc 0.1em; }
      .table td.tinytable_css_e8rtdy7varwkbzcm099m, .table th.tinytable_css_e8rtdy7varwkbzcm099m { border-top: solid #d3d8dc 0.1em; border-bottom: solid #d3d8dc 0.05em; }
    </style>
    <div class="container">
      <table class="table table-borderless" id="tinytable_fku0bo1yl1x02zynd5zy" style="width: auto; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
        <thead>
        
              <tr>
                <th scope="col" data-row="0" data-col="0">Hypothesis</th>
                <th scope="col" data-row="0" data-col="1">Estimate</th>
                <th scope="col" data-row="0" data-col="2">Std. Error</th>
                <th scope="col" data-row="0" data-col="3">z</th>
                <th scope="col" data-row="0" data-col="4">Pr(&gt;|z|)</th>
                <th scope="col" data-row="0" data-col="5">S</th>
                <th scope="col" data-row="0" data-col="6">2.5 %</th>
                <th scope="col" data-row="0" data-col="7">97.5 %</th>
              </tr>
        </thead>
        
        <tbody>
                <tr>
                  <td data-row="1" data-col="0">b2-b1=0</td>
                  <td data-row="1" data-col="1">0.00625</td>
                  <td data-row="1" data-col="2">0.18</td>
                  <td data-row="1" data-col="3">0.0348</td>
                  <td data-row="1" data-col="4">0.972</td>
                  <td data-row="1" data-col="5">0.0</td>
                  <td data-row="1" data-col="6">-0.346</td>
                  <td data-row="1" data-col="7">0.359</td>
                </tr>
        </tbody>
      </table>
    </div>
<!-- hack to avoid NA insertion in last line -->
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># For the sake of completeness, we may also generate age-specific estimates</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Note that the wiggliness of this line will depend on how we modeled age</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>comp <span class="ot">&lt;-</span> <span class="fu">avg_comparisons</span>(mod, <span class="at">variables =</span> <span class="st">"partner"</span>, <span class="at">by =</span> <span class="st">"age"</span>)</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(comp, <span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> estimate, <span class="at">ymin =</span> conf.low, <span class="at">ymax =</span> conf.high)) <span class="sc">+</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="at">alpha =</span> .<span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Association partner and friendship importance"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="relationship_friends_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="ordinal-robustness-check" class="level1">
<h1>Ordinal robustness check</h1>
<p>So far, we have simply conducted linear regressions, but that may be considered suspect given the nature of the outcome: it’s just a five-point response scale ranging from not important at all to very important. And, in fact, barely anybody used the lower response options—more than 40% picked the highest response option. This results in a distribution for which the assumptions of linear regression may be considered heroic.</p>
<p>So, let’s run an ordinal regression to see whether conclusions change. Here, we are going to fit a cumulative ordinal model with a probit link using the ordinal package <a href="https://cran.r-project.org/web/packages/ordinal/index.html" target="_blank">(Christensen, 2023)</a> using the clm() function. In essence, this approach assumes a continuous, normally distributed standardized latent variable (“true” friendship_importance) which is translated into the ordinal response variable following thresholds that are estimated from the data; for example, people who score -3 or less on the standardized latent variable may report that their friends are not important at all, people who score more than that but below -2.7 may pick the second lowest response option, and so on (see <a href="https://journals.sagepub.com/doi/10.1177/2515245918823199" target="_blank">Bürkner &amp; Vuorre, 2019</a> for a proper introduction to these models).</p>
<p>The rest of the model specification remains unchanged:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Outcome as factor variable which is what clm() expects</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>dat<span class="sc">$</span>friendship_importance_factor <span class="ot">&lt;-</span> <span class="fu">factor</span>(dat<span class="sc">$</span>friendship_importance, <span class="at">ordered =</span> <span class="cn">TRUE</span>)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the model</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>mod_ord <span class="ot">&lt;-</span> <span class="fu">clm</span>(friendship_importance_factor <span class="sc">~</span> <span class="fu">bs</span>(age, <span class="at">df =</span> <span class="dv">4</span>) <span class="sc">+</span> gender <span class="sc">+</span> partner <span class="sc">+</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>            <span class="fu">bs</span>(age, <span class="at">df =</span> <span class="dv">4</span>)<span class="sc">:</span>gender <span class="sc">+</span> partner<span class="sc">:</span>gender <span class="sc">+</span> <span class="fu">bs</span>(age, <span class="at">df =</span> <span class="dv">4</span>)<span class="sc">:</span>partner, </span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> dat,</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">link =</span> <span class="st">"probit"</span>)</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Evaluate central comparison in terms of change in response probabilities</span></span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a><span class="fu">avg_comparisons</span>(mod_ord, <span class="at">variables =</span> <span class="st">"partner"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<!-- preamble start -->

    <script>

      function styleCell_ca9eed0s8q5baavqv6m6(i, j, css_id) {
          var table = document.getElementById("tinytable_ca9eed0s8q5baavqv6m6");
          var cell = table.querySelector(`[data-row="${i}"][data-col="${j}"]`);
          if (cell) {
              console.log(`Styling cell at (${i}, ${j}) with class ${css_id}`);
              cell.classList.add(css_id);
          } else {
              console.warn(`Cell at (${i}, ${j}) not found.`);
          }
      }
      function insertSpanRow(i, colspan, content) {
        var table = document.getElementById('tinytable_ca9eed0s8q5baavqv6m6');
        // Find the row with data-row attribute matching i
        var targetRow = table.querySelector(`tr [data-row="${i}"]`).closest('tr');
        var newRow = table.insertRow(targetRow.rowIndex);
        var newCell = newRow.insertCell(0);
        newCell.setAttribute("colspan", colspan);
        newCell.setAttribute("data-col", "0");
        newCell.setAttribute("data-row", i - 1);
        // newCell.innerText = content;
        // this may be unsafe, but innerText does not interpret <br>
        newCell.innerHTML = content;
      }
      function spanCell_ca9eed0s8q5baavqv6m6(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_ca9eed0s8q5baavqv6m6");
        const targetCell = table.querySelector(`[data-row="${i}"][data-col="${j}"]`);
        if (!targetCell) {
          console.warn(`Cell at (${i}, ${j}) not found.`);
        }

        // Get all cells that need to be removed
        const cellsToRemove = [];
        for (let r = 0; r < rowspan; r++) {
          for (let c = 0; c < colspan; c++) {
            if (r === 0 && c === 0) continue; // Skip the target cell
            const cell = table.querySelector(`[data-row="${i + r}"][data-col="${j + c}"]`);
            if (cell) {
              cellsToRemove.push(cell);
            }
          }
        }

        // Remove all cells
        cellsToRemove.forEach(cell => cell.remove());

        // Set rowspan and colspan of the target cell if it exists
        if (targetCell) {
          targetCell.rowSpan = rowspan;
          targetCell.colSpan = colspan;
        }
      }
      // tinytable span after
      window.addEventListener('load', function () {
          var cellsToStyle = [
            // tinytable style arrays after
          { positions: [ { i: '5', j: 0 }, { i: '5', j: 1 }, { i: '5', j: 2 }, { i: '5', j: 3 }, { i: '5', j: 4 }, { i: '5', j: 5 }, { i: '5', j: 6 }, { i: '5', j: 7 },  ], css_id: 'tinytable_css_lsndrexdel3n7off25nj',}, 
          { positions: [ { i: '0', j: 0 }, { i: '0', j: 1 }, { i: '0', j: 2 }, { i: '0', j: 3 }, { i: '0', j: 4 }, { i: '0', j: 5 }, { i: '0', j: 6 }, { i: '0', j: 7 },  ], css_id: 'tinytable_css_lzc9ks2fvhtkoi1h282z',}, 
          ];

          // Loop over the arrays to style the cells
          cellsToStyle.forEach(function (group) {
              group.positions.forEach(function (cell) {
                  styleCell_ca9eed0s8q5baavqv6m6(cell.i, cell.j, group.css_id);
              });
          });
      });
    </script>

    <style>
      /* tinytable css entries after */
      .table td.tinytable_css_lsndrexdel3n7off25nj, .table th.tinytable_css_lsndrexdel3n7off25nj { border-bottom: solid #d3d8dc 0.1em; }
      .table td.tinytable_css_lzc9ks2fvhtkoi1h282z, .table th.tinytable_css_lzc9ks2fvhtkoi1h282z { border-top: solid #d3d8dc 0.1em; border-bottom: solid #d3d8dc 0.05em; }
    </style>
    <div class="container">
      <table class="table table-borderless" id="tinytable_ca9eed0s8q5baavqv6m6" style="width: auto; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
        <thead>
        
              <tr>
                <th scope="col" data-row="0" data-col="0">Group</th>
                <th scope="col" data-row="0" data-col="1">Estimate</th>
                <th scope="col" data-row="0" data-col="2">Std. Error</th>
                <th scope="col" data-row="0" data-col="3">z</th>
                <th scope="col" data-row="0" data-col="4">Pr(&gt;|z|)</th>
                <th scope="col" data-row="0" data-col="5">S</th>
                <th scope="col" data-row="0" data-col="6">2.5 %</th>
                <th scope="col" data-row="0" data-col="7">97.5 %</th>
              </tr>
        </thead>
        
        <tbody>
                <tr>
                  <td data-row="1" data-col="0">1</td>
                  <td data-row="1" data-col="1">0.00170</td>
                  <td data-row="1" data-col="2">0.00436</td>
                  <td data-row="1" data-col="3">0.390</td>
                  <td data-row="1" data-col="4">0.6963</td>
                  <td data-row="1" data-col="5">0.5</td>
                  <td data-row="1" data-col="6">-0.00685</td>
                  <td data-row="1" data-col="7">0.0103</td>
                </tr>
                <tr>
                  <td data-row="2" data-col="0">2</td>
                  <td data-row="2" data-col="1">0.00353</td>
                  <td data-row="2" data-col="2">0.00555</td>
                  <td data-row="2" data-col="3">0.636</td>
                  <td data-row="2" data-col="4">0.5247</td>
                  <td data-row="2" data-col="5">0.9</td>
                  <td data-row="2" data-col="6">-0.00735</td>
                  <td data-row="2" data-col="7">0.0144</td>
                </tr>
                <tr>
                  <td data-row="3" data-col="0">3</td>
                  <td data-row="3" data-col="1">0.02129</td>
                  <td data-row="3" data-col="2">0.01963</td>
                  <td data-row="3" data-col="3">1.085</td>
                  <td data-row="3" data-col="4">0.2780</td>
                  <td data-row="3" data-col="5">1.8</td>
                  <td data-row="3" data-col="6">-0.01718</td>
                  <td data-row="3" data-col="7">0.0598</td>
                </tr>
                <tr>
                  <td data-row="4" data-col="0">4</td>
                  <td data-row="4" data-col="1">0.02896</td>
                  <td data-row="4" data-col="2">0.01641</td>
                  <td data-row="4" data-col="3">1.765</td>
                  <td data-row="4" data-col="4">0.0776</td>
                  <td data-row="4" data-col="5">3.7</td>
                  <td data-row="4" data-col="6">-0.00320</td>
                  <td data-row="4" data-col="7">0.0611</td>
                </tr>
                <tr>
                  <td data-row="5" data-col="0">5</td>
                  <td data-row="5" data-col="1">-0.05549</td>
                  <td data-row="5" data-col="2">0.03847</td>
                  <td data-row="5" data-col="3">-1.442</td>
                  <td data-row="5" data-col="4">0.1492</td>
                  <td data-row="5" data-col="5">2.7</td>
                  <td data-row="5" data-col="6">-0.13089</td>
                  <td data-row="5" data-col="7">0.0199</td>
                </tr>
        </tbody>
      </table>
    </div>
<!-- hack to avoid NA insertion in last line -->
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># these results seem reasonable</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Take the response probabilities and attach the integers 1:5 to the consecutive</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="co"># response categories to arrive at the same metric as the linear model</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="fu">avg_comparisons</span>(mod_ord, <span class="at">variables =</span> <span class="st">"partner"</span>, <span class="at">hypothesis =</span> <span class="sc">~</span> <span class="fu">I</span>(<span class="fu">sum</span>(x <span class="sc">*</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<!-- preamble start -->

    <script>

      function styleCell_bwufbjlnbvxxxapivcut(i, j, css_id) {
          var table = document.getElementById("tinytable_bwufbjlnbvxxxapivcut");
          var cell = table.querySelector(`[data-row="${i}"][data-col="${j}"]`);
          if (cell) {
              console.log(`Styling cell at (${i}, ${j}) with class ${css_id}`);
              cell.classList.add(css_id);
          } else {
              console.warn(`Cell at (${i}, ${j}) not found.`);
          }
      }
      function insertSpanRow(i, colspan, content) {
        var table = document.getElementById('tinytable_bwufbjlnbvxxxapivcut');
        // Find the row with data-row attribute matching i
        var targetRow = table.querySelector(`tr [data-row="${i}"]`).closest('tr');
        var newRow = table.insertRow(targetRow.rowIndex);
        var newCell = newRow.insertCell(0);
        newCell.setAttribute("colspan", colspan);
        newCell.setAttribute("data-col", "0");
        newCell.setAttribute("data-row", i - 1);
        // newCell.innerText = content;
        // this may be unsafe, but innerText does not interpret <br>
        newCell.innerHTML = content;
      }
      function spanCell_bwufbjlnbvxxxapivcut(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_bwufbjlnbvxxxapivcut");
        const targetCell = table.querySelector(`[data-row="${i}"][data-col="${j}"]`);
        if (!targetCell) {
          console.warn(`Cell at (${i}, ${j}) not found.`);
        }

        // Get all cells that need to be removed
        const cellsToRemove = [];
        for (let r = 0; r < rowspan; r++) {
          for (let c = 0; c < colspan; c++) {
            if (r === 0 && c === 0) continue; // Skip the target cell
            const cell = table.querySelector(`[data-row="${i + r}"][data-col="${j + c}"]`);
            if (cell) {
              cellsToRemove.push(cell);
            }
          }
        }

        // Remove all cells
        cellsToRemove.forEach(cell => cell.remove());

        // Set rowspan and colspan of the target cell if it exists
        if (targetCell) {
          targetCell.rowSpan = rowspan;
          targetCell.colSpan = colspan;
        }
      }
      // tinytable span after
      window.addEventListener('load', function () {
          var cellsToStyle = [
            // tinytable style arrays after
          { positions: [ { i: '1', j: 0 }, { i: '1', j: 1 }, { i: '1', j: 2 }, { i: '1', j: 3 }, { i: '1', j: 4 }, { i: '1', j: 5 }, { i: '1', j: 6 },  ], css_id: 'tinytable_css_9w8qrjqtf8ihol4v29bu',}, 
          { positions: [ { i: '0', j: 0 }, { i: '0', j: 1 }, { i: '0', j: 2 }, { i: '0', j: 3 }, { i: '0', j: 4 }, { i: '0', j: 5 }, { i: '0', j: 6 },  ], css_id: 'tinytable_css_953p1xjd4gflyzupknbp',}, 
          ];

          // Loop over the arrays to style the cells
          cellsToStyle.forEach(function (group) {
              group.positions.forEach(function (cell) {
                  styleCell_bwufbjlnbvxxxapivcut(cell.i, cell.j, group.css_id);
              });
          });
      });
    </script>

    <style>
      /* tinytable css entries after */
      .table td.tinytable_css_9w8qrjqtf8ihol4v29bu, .table th.tinytable_css_9w8qrjqtf8ihol4v29bu { border-bottom: solid #d3d8dc 0.1em; }
      .table td.tinytable_css_953p1xjd4gflyzupknbp, .table th.tinytable_css_953p1xjd4gflyzupknbp { border-top: solid #d3d8dc 0.1em; border-bottom: solid #d3d8dc 0.05em; }
    </style>
    <div class="container">
      <table class="table table-borderless" id="tinytable_bwufbjlnbvxxxapivcut" style="width: auto; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
        <thead>
        
              <tr>
                <th scope="col" data-row="0" data-col="0">Estimate</th>
                <th scope="col" data-row="0" data-col="1">Std. Error</th>
                <th scope="col" data-row="0" data-col="2">z</th>
                <th scope="col" data-row="0" data-col="3">Pr(&gt;|z|)</th>
                <th scope="col" data-row="0" data-col="4">S</th>
                <th scope="col" data-row="0" data-col="5">2.5 %</th>
                <th scope="col" data-row="0" data-col="6">97.5 %</th>
              </tr>
        </thead>
        
        <tbody>
                <tr>
                  <td data-row="1" data-col="0">-0.089</td>
                  <td data-row="1" data-col="1">0.0784</td>
                  <td data-row="1" data-col="2">-1.13</td>
                  <td data-row="1" data-col="3">0.257</td>
                  <td data-row="1" data-col="4">2.0</td>
                  <td data-row="1" data-col="5">-0.243</td>
                  <td data-row="1" data-col="6">0.0647</td>
                </tr>
        </tbody>
      </table>
    </div>
<!-- hack to avoid NA insertion in last line -->
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Maybe more reasonable and in the spirit of the orignal model</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Evaluate effect on the underlying latent variable</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="fu">avg_comparisons</span>(mod_ord, <span class="at">variables =</span> <span class="st">"partner"</span>, <span class="at">type =</span> <span class="st">"linear.predictor"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<!-- preamble start -->

    <script>

      function styleCell_sk6ygffxaw7bd4mhqbdz(i, j, css_id) {
          var table = document.getElementById("tinytable_sk6ygffxaw7bd4mhqbdz");
          var cell = table.querySelector(`[data-row="${i}"][data-col="${j}"]`);
          if (cell) {
              console.log(`Styling cell at (${i}, ${j}) with class ${css_id}`);
              cell.classList.add(css_id);
          } else {
              console.warn(`Cell at (${i}, ${j}) not found.`);
          }
      }
      function insertSpanRow(i, colspan, content) {
        var table = document.getElementById('tinytable_sk6ygffxaw7bd4mhqbdz');
        // Find the row with data-row attribute matching i
        var targetRow = table.querySelector(`tr [data-row="${i}"]`).closest('tr');
        var newRow = table.insertRow(targetRow.rowIndex);
        var newCell = newRow.insertCell(0);
        newCell.setAttribute("colspan", colspan);
        newCell.setAttribute("data-col", "0");
        newCell.setAttribute("data-row", i - 1);
        // newCell.innerText = content;
        // this may be unsafe, but innerText does not interpret <br>
        newCell.innerHTML = content;
      }
      function spanCell_sk6ygffxaw7bd4mhqbdz(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_sk6ygffxaw7bd4mhqbdz");
        const targetCell = table.querySelector(`[data-row="${i}"][data-col="${j}"]`);
        if (!targetCell) {
          console.warn(`Cell at (${i}, ${j}) not found.`);
        }

        // Get all cells that need to be removed
        const cellsToRemove = [];
        for (let r = 0; r < rowspan; r++) {
          for (let c = 0; c < colspan; c++) {
            if (r === 0 && c === 0) continue; // Skip the target cell
            const cell = table.querySelector(`[data-row="${i + r}"][data-col="${j + c}"]`);
            if (cell) {
              cellsToRemove.push(cell);
            }
          }
        }

        // Remove all cells
        cellsToRemove.forEach(cell => cell.remove());

        // Set rowspan and colspan of the target cell if it exists
        if (targetCell) {
          targetCell.rowSpan = rowspan;
          targetCell.colSpan = colspan;
        }
      }
      // tinytable span after
      window.addEventListener('load', function () {
          var cellsToStyle = [
            // tinytable style arrays after
          { positions: [ { i: '5', j: 0 }, { i: '5', j: 1 }, { i: '5', j: 2 }, { i: '5', j: 3 }, { i: '5', j: 4 }, { i: '5', j: 5 }, { i: '5', j: 6 }, { i: '5', j: 7 },  ], css_id: 'tinytable_css_gma29skpa8yhxs8blbbz',}, 
          { positions: [ { i: '0', j: 0 }, { i: '0', j: 1 }, { i: '0', j: 2 }, { i: '0', j: 3 }, { i: '0', j: 4 }, { i: '0', j: 5 }, { i: '0', j: 6 }, { i: '0', j: 7 },  ], css_id: 'tinytable_css_7zp5dmkqy4sbx2ozlj2a',}, 
          ];

          // Loop over the arrays to style the cells
          cellsToStyle.forEach(function (group) {
              group.positions.forEach(function (cell) {
                  styleCell_sk6ygffxaw7bd4mhqbdz(cell.i, cell.j, group.css_id);
              });
          });
      });
    </script>

    <style>
      /* tinytable css entries after */
      .table td.tinytable_css_gma29skpa8yhxs8blbbz, .table th.tinytable_css_gma29skpa8yhxs8blbbz { border-bottom: solid #d3d8dc 0.1em; }
      .table td.tinytable_css_7zp5dmkqy4sbx2ozlj2a, .table th.tinytable_css_7zp5dmkqy4sbx2ozlj2a { border-top: solid #d3d8dc 0.1em; border-bottom: solid #d3d8dc 0.05em; }
    </style>
    <div class="container">
      <table class="table table-borderless" id="tinytable_sk6ygffxaw7bd4mhqbdz" style="width: auto; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
        <thead>
        
              <tr>
                <th scope="col" data-row="0" data-col="0">Group</th>
                <th scope="col" data-row="0" data-col="1">Estimate</th>
                <th scope="col" data-row="0" data-col="2">Std. Error</th>
                <th scope="col" data-row="0" data-col="3">z</th>
                <th scope="col" data-row="0" data-col="4">Pr(&gt;|z|)</th>
                <th scope="col" data-row="0" data-col="5">S</th>
                <th scope="col" data-row="0" data-col="6">2.5 %</th>
                <th scope="col" data-row="0" data-col="7">97.5 %</th>
              </tr>
        </thead>
        
        <tbody>
                <tr>
                  <td data-row="1" data-col="0">1</td>
                  <td data-row="1" data-col="1">0.147</td>
                  <td data-row="1" data-col="2">0.107</td>
                  <td data-row="1" data-col="3">1.38</td>
                  <td data-row="1" data-col="4">0.169</td>
                  <td data-row="1" data-col="5">2.6</td>
                  <td data-row="1" data-col="6">-0.0623</td>
                  <td data-row="1" data-col="7">0.355</td>
                </tr>
                <tr>
                  <td data-row="2" data-col="0">2</td>
                  <td data-row="2" data-col="1">0.147</td>
                  <td data-row="2" data-col="2">0.107</td>
                  <td data-row="2" data-col="3">1.38</td>
                  <td data-row="2" data-col="4">0.169</td>
                  <td data-row="2" data-col="5">2.6</td>
                  <td data-row="2" data-col="6">-0.0623</td>
                  <td data-row="2" data-col="7">0.355</td>
                </tr>
                <tr>
                  <td data-row="3" data-col="0">3</td>
                  <td data-row="3" data-col="1">0.147</td>
                  <td data-row="3" data-col="2">0.107</td>
                  <td data-row="3" data-col="3">1.38</td>
                  <td data-row="3" data-col="4">0.169</td>
                  <td data-row="3" data-col="5">2.6</td>
                  <td data-row="3" data-col="6">-0.0623</td>
                  <td data-row="3" data-col="7">0.355</td>
                </tr>
                <tr>
                  <td data-row="4" data-col="0">4</td>
                  <td data-row="4" data-col="1">0.147</td>
                  <td data-row="4" data-col="2">0.107</td>
                  <td data-row="4" data-col="3">1.38</td>
                  <td data-row="4" data-col="4">0.169</td>
                  <td data-row="4" data-col="5">2.6</td>
                  <td data-row="4" data-col="6">-0.0623</td>
                  <td data-row="4" data-col="7">0.355</td>
                </tr>
                <tr>
                  <td data-row="5" data-col="0">5</td>
                  <td data-row="5" data-col="1">0.147</td>
                  <td data-row="5" data-col="2">0.107</td>
                  <td data-row="5" data-col="3">1.37</td>
                  <td data-row="5" data-col="4">0.170</td>
                  <td data-row="5" data-col="5">2.6</td>
                  <td data-row="5" data-col="6">-0.0627</td>
                  <td data-row="5" data-col="7">0.356</td>
                </tr>
        </tbody>
      </table>
    </div>
<!-- hack to avoid NA insertion in last line -->
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># </span><span class="al">NOTE</span><span class="co">: This currently returns the wrong sign. Bug to be fixed</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="varying-the-complexity-of-the-linear-model-to-see-what-happens" class="level1">
<h1>Varying the complexity of the linear model to see what happens</h1>
<p>Let’s vary model complexity to see what happens to our target quantity, the association between having a partner and friendship importance (holding constant age and gender).</p>
<section id="age-variations" class="level2">
<h2 class="anchored" data-anchor-id="age-variations">Age variations</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># No age in the model</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>mod_age_0 <span class="ot">&lt;-</span> <span class="fu">lm</span>(friendship_importance <span class="sc">~</span> gender <span class="sc">+</span> partner <span class="sc">+</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>            partner<span class="sc">:</span>gender, <span class="at">data =</span> dat)</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>comp_age_0 <span class="ot">&lt;-</span> <span class="fu">avg_comparisons</span>(mod_age_0, <span class="at">variables =</span> <span class="st">"partner"</span>)</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>comp_age_0<span class="sc">$</span>model <span class="ot">&lt;-</span> <span class="st">"Not included"</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Linear age in the model</span></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>mod_age_1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(friendship_importance <span class="sc">~</span> age <span class="sc">+</span> gender <span class="sc">+</span> partner <span class="sc">+</span></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>            age<span class="sc">:</span>gender <span class="sc">+</span> partner<span class="sc">:</span>gender <span class="sc">+</span> age<span class="sc">:</span>partner, <span class="at">data =</span> dat)</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>comp_age_1 <span class="ot">&lt;-</span> <span class="fu">avg_comparisons</span>(mod_age_1, <span class="at">variables =</span> <span class="st">"partner"</span>)</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>comp_age_1<span class="sc">$</span>model <span class="ot">&lt;-</span> <span class="st">"Linear"</span></span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Quadratic age on top</span></span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>mod_age_2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(friendship_importance <span class="sc">~</span> <span class="fu">poly</span>(age, <span class="dv">2</span>) <span class="sc">+</span> gender <span class="sc">+</span> partner <span class="sc">+</span></span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>            <span class="fu">poly</span>(age, <span class="dv">2</span>)<span class="sc">:</span>gender <span class="sc">+</span> partner<span class="sc">:</span>gender <span class="sc">+</span> <span class="fu">poly</span>(age, <span class="dv">2</span>)<span class="sc">:</span>partner, <span class="at">data =</span> dat)</span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>comp_age_2 <span class="ot">&lt;-</span> <span class="fu">avg_comparisons</span>(mod_age_2, <span class="at">variables =</span> <span class="st">"partner"</span>)</span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a>comp_age_2<span class="sc">$</span>model <span class="ot">&lt;-</span> <span class="st">"Quadratic"</span></span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Cubic age on top</span></span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a>mod_age_3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(friendship_importance <span class="sc">~</span> <span class="fu">poly</span>(age, <span class="dv">3</span>) <span class="sc">+</span> gender <span class="sc">+</span> partner <span class="sc">+</span></span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a>            <span class="fu">poly</span>(age, <span class="dv">3</span>)<span class="sc">:</span>gender <span class="sc">+</span> partner<span class="sc">:</span>gender <span class="sc">+</span> <span class="fu">poly</span>(age, <span class="dv">3</span>)<span class="sc">:</span>partner, <span class="at">data =</span> dat)</span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a>comp_age_3 <span class="ot">&lt;-</span> <span class="fu">avg_comparisons</span>(mod_age_3, <span class="at">variables =</span> <span class="st">"partner"</span>)</span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a>comp_age_3<span class="sc">$</span>model <span class="ot">&lt;-</span> <span class="st">"Cubic"</span></span>
<span id="cb32-24"><a href="#cb32-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-25"><a href="#cb32-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Quartic age on tope</span></span>
<span id="cb32-26"><a href="#cb32-26" aria-hidden="true" tabindex="-1"></a>mod_age_4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(friendship_importance <span class="sc">~</span> <span class="fu">poly</span>(age, <span class="dv">4</span>) <span class="sc">+</span> gender <span class="sc">+</span> partner <span class="sc">+</span></span>
<span id="cb32-27"><a href="#cb32-27" aria-hidden="true" tabindex="-1"></a>            <span class="fu">poly</span>(age, <span class="dv">4</span>)<span class="sc">:</span>gender <span class="sc">+</span> partner<span class="sc">:</span>gender <span class="sc">+</span> <span class="fu">poly</span>(age, <span class="dv">4</span>)<span class="sc">:</span>partner, <span class="at">data =</span> dat)</span>
<span id="cb32-28"><a href="#cb32-28" aria-hidden="true" tabindex="-1"></a>comp_age_4 <span class="ot">&lt;-</span> <span class="fu">avg_comparisons</span>(mod_age_4, <span class="at">variables =</span> <span class="st">"partner"</span>)</span>
<span id="cb32-29"><a href="#cb32-29" aria-hidden="true" tabindex="-1"></a>comp_age_4<span class="sc">$</span>model <span class="ot">&lt;-</span> <span class="st">"Quartic"</span></span>
<span id="cb32-30"><a href="#cb32-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-31"><a href="#cb32-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Quintic age on tope</span></span>
<span id="cb32-32"><a href="#cb32-32" aria-hidden="true" tabindex="-1"></a>mod_age_5 <span class="ot">&lt;-</span> <span class="fu">lm</span>(friendship_importance <span class="sc">~</span> <span class="fu">poly</span>(age, <span class="dv">5</span>) <span class="sc">+</span> gender <span class="sc">+</span> partner <span class="sc">+</span></span>
<span id="cb32-33"><a href="#cb32-33" aria-hidden="true" tabindex="-1"></a>            <span class="fu">poly</span>(age, <span class="dv">5</span>)<span class="sc">:</span>gender <span class="sc">+</span> partner<span class="sc">:</span>gender <span class="sc">+</span> <span class="fu">poly</span>(age, <span class="dv">5</span>)<span class="sc">:</span>partner, <span class="at">data =</span> dat)</span>
<span id="cb32-34"><a href="#cb32-34" aria-hidden="true" tabindex="-1"></a>comp_age_5 <span class="ot">&lt;-</span> <span class="fu">avg_comparisons</span>(mod_age_4, <span class="at">variables =</span> <span class="st">"partner"</span>)</span>
<span id="cb32-35"><a href="#cb32-35" aria-hidden="true" tabindex="-1"></a>comp_age_5<span class="sc">$</span>model <span class="ot">&lt;-</span> <span class="st">"Quintic"</span></span>
<span id="cb32-36"><a href="#cb32-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-37"><a href="#cb32-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-38"><a href="#cb32-38" aria-hidden="true" tabindex="-1"></a><span class="co"># Age with splines, df = 3</span></span>
<span id="cb32-39"><a href="#cb32-39" aria-hidden="true" tabindex="-1"></a>mod_age_6 <span class="ot">&lt;-</span> <span class="fu">lm</span>(friendship_importance <span class="sc">~</span> <span class="fu">bs</span>(age, <span class="at">df =</span> <span class="dv">3</span>) <span class="sc">+</span> gender <span class="sc">+</span> partner <span class="sc">+</span></span>
<span id="cb32-40"><a href="#cb32-40" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">bs</span>(age, <span class="at">df =</span> <span class="dv">3</span>)<span class="sc">:</span>gender <span class="sc">+</span> partner<span class="sc">:</span>gender <span class="sc">+</span> <span class="fu">bs</span>(age, <span class="at">df =</span> <span class="dv">3</span>)<span class="sc">:</span>partner, <span class="at">data =</span> dat)</span>
<span id="cb32-41"><a href="#cb32-41" aria-hidden="true" tabindex="-1"></a>comp_age_6 <span class="ot">&lt;-</span> <span class="fu">avg_comparisons</span>(mod_age_6, <span class="at">variables =</span> <span class="st">"partner"</span>)</span>
<span id="cb32-42"><a href="#cb32-42" aria-hidden="true" tabindex="-1"></a>comp_age_6<span class="sc">$</span>model <span class="ot">&lt;-</span> <span class="st">"Splines, df = 3"</span></span>
<span id="cb32-43"><a href="#cb32-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-44"><a href="#cb32-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-45"><a href="#cb32-45" aria-hidden="true" tabindex="-1"></a><span class="co"># Splines, df = 4 (same as model reported in main text)</span></span>
<span id="cb32-46"><a href="#cb32-46" aria-hidden="true" tabindex="-1"></a>mod_age_7 <span class="ot">&lt;-</span> <span class="fu">lm</span>(friendship_importance <span class="sc">~</span> <span class="fu">bs</span>(age, <span class="at">df =</span> <span class="dv">4</span>) <span class="sc">+</span> gender <span class="sc">+</span> partner <span class="sc">+</span></span>
<span id="cb32-47"><a href="#cb32-47" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">bs</span>(age, <span class="at">df =</span> <span class="dv">3</span>)<span class="sc">:</span>gender <span class="sc">+</span> partner<span class="sc">:</span>gender <span class="sc">+</span> <span class="fu">bs</span>(age, <span class="at">df =</span> <span class="dv">3</span>)<span class="sc">:</span>partner, <span class="at">data =</span> dat)</span>
<span id="cb32-48"><a href="#cb32-48" aria-hidden="true" tabindex="-1"></a>comp_age_7 <span class="ot">&lt;-</span> <span class="fu">avg_comparisons</span>(mod_age_7, <span class="at">variables =</span> <span class="st">"partner"</span>)</span>
<span id="cb32-49"><a href="#cb32-49" aria-hidden="true" tabindex="-1"></a>comp_age_7<span class="sc">$</span>model <span class="ot">&lt;-</span> <span class="st">"Splines, df = 4"</span></span>
<span id="cb32-50"><a href="#cb32-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-51"><a href="#cb32-51" aria-hidden="true" tabindex="-1"></a><span class="co"># Splines, df = 5</span></span>
<span id="cb32-52"><a href="#cb32-52" aria-hidden="true" tabindex="-1"></a>mod_age_8 <span class="ot">&lt;-</span> <span class="fu">lm</span>(friendship_importance <span class="sc">~</span> <span class="fu">bs</span>(age, <span class="at">df =</span> <span class="dv">5</span>) <span class="sc">+</span> gender <span class="sc">+</span> partner <span class="sc">+</span></span>
<span id="cb32-53"><a href="#cb32-53" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">bs</span>(age, <span class="at">df =</span> <span class="dv">5</span>)<span class="sc">:</span>gender <span class="sc">+</span> partner<span class="sc">:</span>gender <span class="sc">+</span> <span class="fu">bs</span>(age, <span class="at">df =</span> <span class="dv">5</span>)<span class="sc">:</span>partner, <span class="at">data =</span> dat)</span>
<span id="cb32-54"><a href="#cb32-54" aria-hidden="true" tabindex="-1"></a>comp_age_8 <span class="ot">&lt;-</span> <span class="fu">avg_comparisons</span>(mod_age_8, <span class="at">variables =</span> <span class="st">"partner"</span>)</span>
<span id="cb32-55"><a href="#cb32-55" aria-hidden="true" tabindex="-1"></a>comp_age_8<span class="sc">$</span>model <span class="ot">&lt;-</span> <span class="st">"Splines, df = 5"</span></span>
<span id="cb32-56"><a href="#cb32-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-57"><a href="#cb32-57" aria-hidden="true" tabindex="-1"></a><span class="co"># Splines, df = 6</span></span>
<span id="cb32-58"><a href="#cb32-58" aria-hidden="true" tabindex="-1"></a>mod_age_9 <span class="ot">&lt;-</span> <span class="fu">lm</span>(friendship_importance <span class="sc">~</span> <span class="fu">bs</span>(age, <span class="at">df =</span> <span class="dv">6</span>) <span class="sc">+</span> gender <span class="sc">+</span> partner <span class="sc">+</span></span>
<span id="cb32-59"><a href="#cb32-59" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">bs</span>(age, <span class="at">df =</span> <span class="dv">6</span>)<span class="sc">:</span>gender <span class="sc">+</span> partner<span class="sc">:</span>gender <span class="sc">+</span> <span class="fu">bs</span>(age, <span class="at">df =</span> <span class="dv">6</span>)<span class="sc">:</span>partner, <span class="at">data =</span> dat)</span>
<span id="cb32-60"><a href="#cb32-60" aria-hidden="true" tabindex="-1"></a>comp_age_9 <span class="ot">&lt;-</span> <span class="fu">avg_comparisons</span>(mod_age_8, <span class="at">variables =</span> <span class="st">"partner"</span>)</span>
<span id="cb32-61"><a href="#cb32-61" aria-hidden="true" tabindex="-1"></a>comp_age_9<span class="sc">$</span>model <span class="ot">&lt;-</span> <span class="st">"Splines, df = 6"</span></span>
<span id="cb32-62"><a href="#cb32-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-63"><a href="#cb32-63" aria-hidden="true" tabindex="-1"></a><span class="co"># Put all the comparisons from the different model</span></span>
<span id="cb32-64"><a href="#cb32-64" aria-hidden="true" tabindex="-1"></a><span class="co"># into one dataframe for plotting purposes</span></span>
<span id="cb32-65"><a href="#cb32-65" aria-hidden="true" tabindex="-1"></a>comp_age <span class="ot">&lt;-</span> <span class="fu">rbind</span>(<span class="fu">data.frame</span>(comp_age_0), <span class="fu">data.frame</span>(comp_age_1), </span>
<span id="cb32-66"><a href="#cb32-66" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">data.frame</span>(comp_age_2), <span class="fu">data.frame</span>(comp_age_3),</span>
<span id="cb32-67"><a href="#cb32-67" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">data.frame</span>(comp_age_4), <span class="fu">data.frame</span>(comp_age_5),</span>
<span id="cb32-68"><a href="#cb32-68" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">data.frame</span>(comp_age_6), <span class="fu">data.frame</span>(comp_age_7),</span>
<span id="cb32-69"><a href="#cb32-69" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">data.frame</span>(comp_age_8), <span class="fu">data.frame</span>(comp_age_9))</span>
<span id="cb32-70"><a href="#cb32-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-71"><a href="#cb32-71" aria-hidden="true" tabindex="-1"></a><span class="co"># Numbering (for plotting purposes)</span></span>
<span id="cb32-72"><a href="#cb32-72" aria-hidden="true" tabindex="-1"></a>comp_age<span class="sc">$</span>no <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(comp_age)</span>
<span id="cb32-73"><a href="#cb32-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-74"><a href="#cb32-74" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate the plot</span></span>
<span id="cb32-75"><a href="#cb32-75" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(comp_age, <span class="fu">aes</span>(<span class="at">x =</span> no, <span class="at">y =</span> estimate, <span class="at">ymin =</span> conf.low, <span class="at">ymax =</span> conf.high)) <span class="sc">+</span></span>
<span id="cb32-76"><a href="#cb32-76" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb32-77"><a href="#cb32-77" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>() <span class="sc">+</span></span>
<span id="cb32-78"><a href="#cb32-78" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb32-79"><a href="#cb32-79" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.4</span>, <span class="fl">0.4</span>)) <span class="sc">+</span></span>
<span id="cb32-80"><a href="#cb32-80" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> comp_age<span class="sc">$</span>no, <span class="at">labels =</span> comp_age<span class="sc">$</span>model) <span class="sc">+</span></span>
<span id="cb32-81"><a href="#cb32-81" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb32-82"><a href="#cb32-82" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Way that age is included in model"</span>) <span class="sc">+</span></span>
<span id="cb32-83"><a href="#cb32-83" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Target quantity (95% CI)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="relationship_friends_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">here</span>(<span class="st">"plots/age_robustness.png"</span>), <span class="at">width =</span> <span class="dv">4</span>, <span class="at">height =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="interaction-variations" class="level2">
<h2 class="anchored" data-anchor-id="interaction-variations">Interaction variations</h2>
<p>Let’s see whether the inclusion of interactions makes a difference</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># No interactions</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>mod_interact_1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(friendship_importance <span class="sc">~</span> <span class="fu">bs</span>(age, <span class="at">df =</span> <span class="dv">4</span>) <span class="sc">+</span> gender <span class="sc">+</span> partner, <span class="at">data =</span> dat)</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>comp_interact_1 <span class="ot">&lt;-</span> <span class="fu">avg_comparisons</span>(mod_interact_1, <span class="at">variables =</span> <span class="st">"partner"</span>)</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>comp_interact_1<span class="sc">$</span>model <span class="ot">&lt;-</span> <span class="st">"No interaction"</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Add two-way interactions (same as model reported in main text)</span></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>mod_interact_2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(friendship_importance <span class="sc">~</span> <span class="fu">bs</span>(age, <span class="at">df =</span> <span class="dv">4</span>) <span class="sc">+</span> gender <span class="sc">+</span> partner <span class="sc">+</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">bs</span>(age, <span class="at">df =</span> <span class="dv">4</span>)<span class="sc">:</span>gender <span class="sc">+</span> partner<span class="sc">:</span>gender <span class="sc">+</span> <span class="fu">bs</span>(age, <span class="at">df =</span> <span class="dv">4</span>)<span class="sc">:</span>partner, <span class="at">data =</span> dat)</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>comp_interact_2 <span class="ot">&lt;-</span> <span class="fu">avg_comparisons</span>(mod_interact_2, <span class="at">variables =</span> <span class="st">"partner"</span>)</span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>comp_interact_2<span class="sc">$</span>model <span class="ot">&lt;-</span> <span class="st">"Two-way interactions"</span></span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Add three-way interaction</span></span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>mod_interact_3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(friendship_importance <span class="sc">~</span> <span class="fu">bs</span>(age, <span class="at">df =</span> <span class="dv">4</span>)<span class="sc">*</span>gender<span class="sc">*</span>partner, <span class="at">data =</span> dat)</span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>comp_interact_3 <span class="ot">&lt;-</span> <span class="fu">avg_comparisons</span>(mod_interact_3, <span class="at">variables =</span> <span class="st">"partner"</span>)</span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a>comp_interact_3<span class="sc">$</span>model <span class="ot">&lt;-</span> <span class="st">"Three-way interaction"</span></span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Put all the comparisons from the different model</span></span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a><span class="co"># into one dataframe for plotting purposes</span></span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a>comp_interact <span class="ot">&lt;-</span> <span class="fu">rbind</span>(<span class="fu">data.frame</span>(comp_interact_1), <span class="fu">data.frame</span>(comp_interact_2), <span class="fu">data.frame</span>(comp_interact_3))</span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Numbering (for plotting purposes)</span></span>
<span id="cb34-22"><a href="#cb34-22" aria-hidden="true" tabindex="-1"></a>comp_interact<span class="sc">$</span>no <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(comp_interact)</span>
<span id="cb34-23"><a href="#cb34-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-24"><a href="#cb34-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the results</span></span>
<span id="cb34-25"><a href="#cb34-25" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(comp_interact, <span class="fu">aes</span>(<span class="at">x =</span> no, <span class="at">y =</span> estimate, <span class="at">ymin =</span> conf.low, <span class="at">ymax =</span> conf.high)) <span class="sc">+</span></span>
<span id="cb34-26"><a href="#cb34-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb34-27"><a href="#cb34-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>() <span class="sc">+</span></span>
<span id="cb34-28"><a href="#cb34-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb34-29"><a href="#cb34-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.4</span>, <span class="fl">0.4</span>)) <span class="sc">+</span></span>
<span id="cb34-30"><a href="#cb34-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> comp_interact<span class="sc">$</span>no, <span class="at">labels =</span> comp_interact<span class="sc">$</span>model) <span class="sc">+</span></span>
<span id="cb34-31"><a href="#cb34-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb34-32"><a href="#cb34-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Interactions included"</span>) <span class="sc">+</span></span>
<span id="cb34-33"><a href="#cb34-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Estimated difference in friendship importance"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="relationship_friends_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>